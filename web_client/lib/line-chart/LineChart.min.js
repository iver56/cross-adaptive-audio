var n3Charts;!function(t){var e;!function(t){"use strict";function e(){function t(t,e,i){t.attr("transform",function(t){var n=e(t.value);return"translate("+(isFinite(n)?n:i(t.value))+",0)"})}function e(t,e,i){t.attr("transform",function(t){var n=e(t.value);return"translate(0,"+(isFinite(n)?n:i(t.value))+")"})}function i(t){var e=t[0],i=t[t.length-1];return i>e?[e,i]:[i,e]}function n(t){return t.rangeExtent?t.rangeExtent():i(t.range())}var r,o=([].slice,"bottom"),s={top:1,right:1,bottom:1,left:1},a=d3.scale.linear(),c=o,u=6,p=24,h=-6,l=0,d=5,f=null,g=null,y=function(i,o,s,a,f){var g,y="major"===o,v=y?p:l,m=y?h:d,x=f.selectAll(".tick."+o).data(i,function(t){return a(t.value)}),O=x.enter().insert("g",".domain").attr("class","tick "+o).style("opacity",1e-6),S=d3.transition(x.exit()).style("opacity",1e-6).remove(),M=d3.transition(x.order()).style("opacity",1),A=Math.max(v,0)+m,F=n(a),b=f.selectAll(".domain").data([0]),w=(b.enter().append("path").attr("class","domain"),b.transition());O.append("line"),O.append("text");var E,C,D,k,T=O.select("line"),z=M.select("line"),I=x.select("text").text(function(t,e){return r?r(t,e):t.label}),_=O.select("text"),B=M.select("text"),U="top"===c||"left"===c?-1:1;"bottom"===c||"top"===c?(g=t,E="x",D="y",C="x2",k="y2",I.attr({dy:0>U?"0em":".8em",dx:"5px"}).style("text-anchor","left"),w.attr("d","M"+F[0]+","+U*u+"V0H"+F[1]+"V"+U*u)):(g=e,E="y",D="x",C="y2",k="x2",I.attr({dy:".32em",dx:0>U?-A+"px":A+"px"}).style("text-anchor",0>U?"end":"start"),w.attr("d","M"+U*u+","+F[0]+"H0V"+F[1]+"H"+U*u)),T.attr(k,U*v),_.attr(D,U*A),z.attr(C,0).attr(k,U*v),B.attr(E,0).attr(D,U*A),S.call(g,a,s),O.call(g,s,a),M.call(g,a,a)},v=function(t){t.each(function(){var t=d3.select(this),e=this.__chart__||a,i=this.__chart__=a.copy(),n=f(i.domain()),r=n.major,o=n.minor;y(r,"major",e,i,t),y(o,"minor",e,i,t)})};return v.scale=function(t){return arguments.length?(a=t,v):a},v.orient=function(t){return arguments.length?(c=t in s?t+"":o,v):c},v.ticks=function(t){return arguments.length?(f=t,v):f},v.tickValues=function(t){return arguments.length?(g=t,v):g},v.tickFormat=function(t){return arguments.length?(r=t,v):r},v.tickSize=function(t){var e=arguments.length;return e?(p=+t,u=+arguments[e-1],l=+t,v):p},v.innerTickSize=function(t){return arguments.length?(p=+t,v):p},v.outerTickSize=function(t){return arguments.length?(u=+t,v):u},v.tickPadding=function(t){return arguments.length?(h=+t,v):h},v}t.twoSpeedAxis=e}(e=t.svg||(t.svg={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var e;!function(e){"use strict";var i=function(){function i(e){void 0===e&&(e={}),this.axis="y",this.type=["line"],this.visible=!0,this.defined=function(t){return!0};var i=this.sanitizeOptions(e);this.id=i.id||t.Utils.UUID.generate(),this.axis=i.axis,this.interpolation=i.interpolation,this.dataset=i.dataset,this.key=i.key,this.color=i.color,this.visible=i.visible,this.label=i.label||i.id,i.defined&&(this.defined=i.defined),i.type.length>0&&(this.type=this.sanitizeType(i.type))}return i.prototype.sanitizeOptions=function(t){var i={};return angular.extend(i,this,t),i.axis=this.sanitizeAxis(i.axis),i.interpolation=this.sanitizeInterpolation(i.interpolation),i.id=e.Options.getString(i.id),i.type=e.Options.getArray(i.type),i.dataset=e.Options.getString(i.dataset),i.key=this.sanitizeKeys(i.key),i.color=e.Options.getString(i.color),i.label=e.Options.getString(i.label),i.visible=e.Options.getBoolean(i.visible),i.defined=e.Options.getFunction(i.defined),i},i.prototype.sanitizeInterpolation=function(t){return t?{mode:e.Options.getString(t.mode,"linear"),tension:e.Options.getNumber(t.tension,.7)}:{mode:"linear",tension:.7}},i.prototype.sanitizeKeys=function(t){return t?"string"==typeof t?{y1:e.Options.getString(t)}:{y0:e.Options.getString(t.y0),y1:e.Options.getString(t.y1)}:{y1:void 0}},i.prototype.getToggledVisibility=function(){return!this.visible},i.prototype.sanitizeType=function(t){return t.filter(function(t){return i.isValidType(t)?!0:(console.warn("Unknow series type : "+t),!1)})},i.prototype.sanitizeAxis=function(t){if(-1===["y","y2"].indexOf(t))throw TypeError(t+" is not a valid series option for axis.");return t},i.prototype.isAColumn=function(){return this.hasType(i.TYPE.COLUMN)},i.prototype.isDashed=function(){return-1!==this.type.indexOf(i.TYPE.DASHED_LINE)},i.prototype.hasType=function(t){return t===i.TYPE.LINE?-1!==this.type.indexOf(t)||-1!==this.type.indexOf(i.TYPE.DASHED_LINE):-1!==this.type.indexOf(t)},i.prototype.hasTwoKeys=function(){return void 0!==this.key.y0},i.isValidType=function(t){return-1!==d3.values(i.TYPE).indexOf(t)},i.TYPE={DOT:"dot",LINE:"line",DASHED_LINE:"dashed-line",AREA:"area",COLUMN:"column"},i}();e.SeriesOptions=i}(e=t.Options||(t.Options={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var e;!function(t){"use strict";var e=function(){function e(t){void 0===t&&(t={}),this.type="linear",this.key="x",this.ticksShift={x:0,y:0},this.parse(t)}return e.prototype.parse=function(i){this.type=t.Options.getString(i.type,"linear"),this.key=i.key,this.tickFormat=t.Options.getFunction(i.tickFormat),this.ticks=i.ticks,i.ticksShift&&(this.ticksShift={x:t.Options.getNumber(i.ticksShift.x,0),y:t.Options.getNumber(i.ticksShift.y,0)}),this.type===e.TYPE.LINEAR?(this.min=t.Options.getNumber(i.min,void 0),this.max=t.Options.getNumber(i.max,void 0)):this.type===e.TYPE.DATE&&(this.min=t.Options.getDate(i.min,void 0),this.max=t.Options.getDate(i.max,void 0))},e.isValidSide=function(t){return-1!==d3.values(e.SIDE).indexOf(t)},e.prototype.hasDynamicTicks=function(){return this.ticks instanceof Function},e.prototype.configure=function(t){return t.tickFormat(this.tickFormat),this.ticks instanceof Array?t.tickValues(this.ticks):"number"==typeof this.ticks?t.ticks(this.ticks):this.ticks instanceof Function&&t.ticks(this.ticks),t},e.SIDE={X:"x",X2:"x2",Y:"y",Y2:"y2"},e.TYPE={LINEAR:"linear",DATE:"date",LOG:"log"},e}();t.AxisOptions=e}(e=t.Options||(t.Options={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var e;!function(t){"use strict";var e=function(){function e(){this.width=600,this.height=200,this.innerWidth=560,this.innerHeight=160,this.margin=e.getDefaultMargins()}return e.getDefaultMargins=function(){return{top:0,left:40,bottom:40,right:40}},e.prototype.updateMargins=function(e){var i=this;if(e&&e.margin){var n=function(n){return i.margin[n]=t.Options.getNumber(e.margin[n],i.margin[n])};n("top"),n("bottom"),n("left"),n("right")}},e.prototype.getDimensionByProperty=function(t,e){var i=window.getComputedStyle(t,null);return+i.getPropertyValue(e).replace(/px$/,"")},e.prototype.fromParentElement=function(t){var e=this.getDimensionByProperty(t,"padding-left")+this.getDimensionByProperty(t,"padding-right"),i=this.getDimensionByProperty(t,"padding-top")+this.getDimensionByProperty(t,"padding-bottom");this.width=t.clientWidth-e,this.height=t.clientHeight-i,this.innerHeight=this.height-this.margin.top-this.margin.bottom,this.innerWidth=this.width-this.margin.left-this.margin.right},e}();t.Dimensions=e}(e=t.Options||(t.Options={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var e;!function(t){"use strict";var e=function(){function e(e){this.series=[],this.pan={x:!1,y:!1},this.zoom={x:!1,y:!1},this.axes={x:{},y:{}},this.margin=t.Dimensions.getDefaultMargins(),this.grid={x:!1,y:!0};var i=this.sanitizeOptions(e);this.margin=i.margin,this.series=i.series,this.axes=i.axes,this.pan=i.pan,this.zoom=i.zoom,this.grid=i.grid,this.tooltipHook=i.tooltipHook}return e.prototype.sanitizeOptions=function(t){var i={};return angular.extend(i,this,t),i.margin=this.sanitizeMargin(e.getObject(i.margin,this.margin)),i.series=this.sanitizeSeries(e.getArray(i.series)),i.axes=this.sanitizeAxes(e.getObject(i.axes,this.axes)),i.grid=this.sanitizeTwoAxesOptions(i.grid,this.grid),i.pan=this.sanitizeTwoAxesOptions(i.pan,this.pan),i.zoom=this.sanitizeTwoAxesOptions(i.zoom,this.zoom),i.tooltipHook=e.getFunction(i.tooltipHook),i},e.prototype.sanitizeMargin=function(t){return{top:e.getNumber(t.top,0),left:e.getNumber(t.left,0),bottom:e.getNumber(t.bottom,0),right:e.getNumber(t.right,0)}},e.prototype.sanitizeSeries=function(e){return e.map(function(e){return new t.SeriesOptions(e)})},e.prototype.sanitizeTwoAxesOptions=function(t,i){var n={x:e.getBoolean(t.x,i.x),y:e.getBoolean(t.y,i.y)};return n},e.prototype.sanitizeAxes=function(e){return Object.keys(e).reduce(function(i,n){return i[n]=new t.AxisOptions(e[n]),i},{})},e.prototype.getAbsKey=function(){if(!this.axes[t.AxisOptions.SIDE.X])throw new TypeError("Cannot find abs key : "+t.AxisOptions.SIDE.X);return this.axes[t.AxisOptions.SIDE.X].key},e.prototype.getVisibleDatasets=function(){var t=[];return this.series.forEach(function(e){e.visible&&-1===t.indexOf(e.dataset)&&t.push(e.dataset)}),t},e.prototype.getSeriesAndDatasetBySide=function(e){if(!t.AxisOptions.isValidSide(e))throw new TypeError("Cannot get axis side : "+e);e!==t.AxisOptions.SIDE.Y2||this.axes[e]||(e=t.AxisOptions.SIDE.Y);var i=[],n={};return this.series.forEach(function(t){t.visible&&t.axis===e&&(i.push(t.dataset),n[t.dataset]||(n[t.dataset]=[]),n[t.dataset].push(t))}),{seriesForDataset:n,datasetsForSide:i}},e.prototype.getByAxisSide=function(e){if(!t.AxisOptions.isValidSide(e))throw new TypeError("Cannot get axis side : "+e);if(!this.axes[e]){if(e===t.AxisOptions.SIDE.Y2)return this.axes[t.AxisOptions.SIDE.Y];if(e===t.AxisOptions.SIDE.X2)return this.axes[t.AxisOptions.SIDE.X]}return this.axes[e]},e.prototype.getSeriesByType=function(e){if(!t.SeriesOptions.isValidType(e))throw new TypeError("Unknown series type: "+e);return this.series.filter(function(t){return t.hasType(e)})},e.getBoolean=function(t,e){return void 0===e&&(e=!0),"boolean"==typeof t?t:e},e.getNumber=function(t,e){var i=parseFloat(t);return isNaN(i)?e:i},e.getDate=function(t,e){return t instanceof Date?t:e},e.getFunction=function(t){return t instanceof Function?t:void 0},e.getString=function(t,e){return t?String(t):e},e.getIdentifier=function(t){var i=e.getString(t);return i.replace(/[^a-zA-Z0-9\-_]/gi,"")},e.getObject=function(t,e){if(void 0===e&&(e={}),!angular.isObject(t))throw TypeError(t+" option must be an object.");var i={};return angular.extend(i,e,t),i},e.getArray=function(t,e){return void 0===e&&(e=[]),e.concat(t)},e}();t.Options=e}(e=t.Options||(t.Options={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var e;!function(t){"use strict";var e=function(){function t(){this.strictMode=!0}return t.prototype.init=function(t){var e=this;this._dispatch=d3.dispatch.apply(this,t);var i=(new Date).getTime();return d3.select(window).on("mouseup."+i,function(){return e.trigger("window-mouseup")}),d3.select(window).on("mousemove."+i,function(){return e.trigger("window-mousemove")}),this},t.prototype.update=function(t,e){this.data=t,this.options=e},t.prototype.on=function(e,i){if(this.strictMode&&-1===t.EVENTS.indexOf(e.split(".")[0]))throw new Error("Unknown event: "+e);return this._dispatch.on(e,i),this},t.prototype.trigger=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return this._dispatch[t].apply(this,e),this},t.prototype.triggerDataAndOptions=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return e.push(this.data),e.push(this.options),this._dispatch[t].apply(this,e),this},t.prototype.datumEnter=function(t,e){var i=this;return function(n){return n.on("mouseenter",function(n,r){i.trigger("enter",n,r,t,e)})}},t.prototype.datumOver=function(t,e){var i=this;return function(n){return n.on("mouseover",function(n,r){i.trigger("over",n,r,t,e)})}},t.prototype.datumMove=function(t,e){var i=this;return function(n){return n.on("mousemove",function(n,r){i.trigger("over",n,r,t,e)})}},t.prototype.datumLeave=function(t,e){var i=this;return function(n){return n.on("mouseleave",function(n,r){i.trigger("leave",n,r,t,e)})}},t.prototype.listenForDblClick=function(t,e,i){var n,r,o=5,s=null,a=function(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))};return t.on("mousedown.dbl."+i,function(){n=d3.mouse(document.body),r=(new Date).getTime()}),t.on("mouseup.dbl."+i,function(){a(n,d3.mouse(document.body))>o||(s?(window.clearTimeout(s),s=null,e(d3.event)):s=window.setTimeout(function(t){return function(){s=null}}(d3.event),300))}),t},t.EVENTS=["create","update","data-update","resize","destroy","enter","over","move","leave","click","dblclick","legend-click","legend-over","legend-out","container-over","container-move","container-out","focus","toggle","outer-world-hover","outer-world-domain-change","pan","pan-end","zoom","zoom-end","zoom-pan-reset","window-mouseup","window-mousemove"],t}();t.EventManager=e}(e=t.Utils||(t.Utils={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var e;!function(t){"use strict";var e=function(){function t(){this._factoryStack=[]}return t.prototype.index=function(t){return this._factoryStack.map(function(t){return t.key}).indexOf(t)},t.prototype.getBoundFunction=function(t,e){var i=this.get(t);return i?i[e].bind(i):null},t.prototype.get=function(t){var e=this.index(t);return e>-1?this._factoryStack[e].instance:null},t.prototype.all=function(){return this._factoryStack},t.prototype.turnFactoriesOff=function(t){var e=this,i=[];return t.forEach(function(t){var n=e.get(t);n.isOn()&&(n.off(),i.push(t))}),function(){return e.turnFactoriesOn(i)}},t.prototype.turnFactoriesOn=function(t){var e=this,i=[];return t.forEach(function(t){var n=e.get(t);n.isOff()&&(n.on(),i.push(t))}),function(){return e.turnFactoriesOff(i)}},t.prototype.registerMany=function(t){var e=this;return t.forEach(function(t){e.register.apply(e,t)}),this},t.prototype.register=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];var r=e.bind.apply(e,[null].concat(i)),o=new r;return this._factoryStack.push({key:t,instance:o}),o},t.prototype.unregister=function(t){var e=this.index(t);return e>-1&&delete this._factoryStack[e],this},t}();t.FactoryManager=e}(e=t.Utils||(t.Utils={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var e;!function(t){"use strict";var e=function(){function t(t,e){this.fromJS(t,e)}return t.prototype.fromJS=function(t,e){this.id=e,this.values=t},t}();t.Dataset=e}(e=t.Utils||(t.Utils={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var e;!function(t){"use strict";var e=function(){function e(t){t&&this.fromJS(t)}return e.prototype.fromJS=function(e){var i={};for(var n in e)e.hasOwnProperty(n)&&(i[n]=new t.Dataset(e[n],n));this.sets=i},e.prototype.getDatasets=function(t,e){var i=this;return t.map(function(t){return i.getDatasetValues(t,e)})},e.prototype.getDatasetValues=function(t,e){if(!this.sets||!this.sets[t.dataset].values)return[];var i,n=e.getAbsKey();return i=t.key.y0?function(e){return{x:e[n],y1:e[t.key.y1],y0:e[t.key.y0]}}:function(e){return{x:e[n],y1:e[t.key.y1],y0:0}},this.sets[t.dataset].values.map(i)},e.getMinDistance=function(t,e,i,n){return void 0===i&&(i="x"),d3.min(t.map(function(t){return t.map(function(t){return e(t[i])}).filter(function(t){return n?t>=n[0]&&t<=n[1]:!0}).reduce(function(t,e,i,n){var r=i>0?e-n[i-1]:Number.MAX_VALUE;return t>r?r:t},Number.MAX_VALUE)}))},e}();t.Data=e}(e=t.Utils||(t.Utils={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var e;!function(t){"use strict";var e=function(){function t(){}return t.debounce=function(t,e){var i=this,n=null;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o-0]=arguments[o];n&&window.clearTimeout(n),n=window.setTimeout(function(){return t.apply(i,r)},e)}},t}();t.FunctionUtils=e;var i=function(){function t(){}return t.generate=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,i="x"===t?e:3&e|8;return i.toString(16)})},t}();t.UUID=i}(e=t.Utils||(t.Utils={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var e;!function(t){"use strict";var e=function(){function t(){this.enabled=!0}return t.prototype.init=function(t,e,i){this.key=t,this.eventMgr=e,this.factoryMgr=i,this.eventMgr.on("create."+this.key,this.create.bind(this)),this.eventMgr.on("update."+this.key,this.update.bind(this)),this.eventMgr.on("destroy."+this.key,this.destroy.bind(this))},t.prototype.on=function(){this.enabled=!0},t.prototype.off=function(){this.enabled=!1},t.prototype.isOn=function(){return this.enabled===!0},t.prototype.isOff=function(){return this.enabled===!1},t.prototype.create=function(t){},t.prototype.update=function(t,e){},t.prototype.destroy=function(){},t}();t.BaseFactory=e}(e=t.Factory||(t.Factory={}))}(n3Charts||(n3Charts={}));var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},n3Charts;!function(t){var e;!function(e){"use strict";var i=function(e){function i(i){e.call(this),this.element=i,this.dim=new t.Options.Dimensions}return __extends(i,e),i.prototype.create=function(t){var e=this;this.dim.updateMargins(t),this.listenToElement(this.element,t),this.createRoot(),this.createContainer(),this.dim.fromParentElement(this.element.parentElement),this.eventMgr.on("resize",function(){e.dim.fromParentElement(e.element.parentElement),e.update()}),this.eventMgr.listenForDblClick(this.svg,function(){e.eventMgr.trigger("zoom-pan-reset",!0)},this.key),this.eventMgr.on("zoom-pan-reset."+this.key,function(t){e.eventMgr.triggerDataAndOptions("update")})},i.prototype.listenToElement=function(t,e){var i=this.eventMgr;t.addEventListener("mouseover",function(t){i.triggerDataAndOptions.apply(i,["container-over",t])}),t.addEventListener("mousemove",function(t){i.triggerDataAndOptions.apply(i,["container-move",t])}),t.addEventListener("mouseout",function(t){i.triggerDataAndOptions.apply(i,["container-out",t])})},i.prototype.getCoordinatesFromEvent=function(t){var e=this.getDimensions(),i=t.currentTarget.getBoundingClientRect(),n=i.left,r=i.top,o=this.factoryMgr.get("x-axis").scale,s=o.invert(t.clientX-n-e.margin.left),a=this.factoryMgr.get("y-axis").scale,c=a.invert(t.clientY-r-e.margin.top);return(c<a.domain()[0]||c>a.domain()[1])&&(c=void 0),(s<o.domain()[0]||s>o.domain()[1])&&(s=void 0),{y:c,x:s}},i.prototype.update=function(){this.updateRoot(),this.updateContainer()},i.prototype.destroy=function(){this.destroyRoot()},i.prototype.createRoot=function(){this.svg=d3.select(this.element).append("svg").attr("class","chart"),this.defs=this.svg.append("defs")},i.prototype.updateRoot=function(){this.svg.attr("width",this.dim.width).attr("height",this.dim.height)},i.prototype.destroyRoot=function(){this.svg.remove()},i.prototype.createContainer=function(){this.vis=this.svg.append("g").attr("class","container"),this.axes=this.vis.append("g").attr("class","axes"),this.clippingPathId="clipping-path-"+t.Utils.UUID.generate(),this.defs.append("svg:clipPath").attr("id",this.clippingPathId).append("svg:rect").attr("id","clipping-rect"),this.data=this.vis.append("g").attr({"class":"data","clip-path":"url(#"+this.clippingPathId+")"}),this.overlay=this.vis.append("g").attr("class","overlay")},i.prototype.updateContainer=function(){this.vis.attr({width:this.dim.innerWidth,height:Math.max(this.dim.innerHeight,0),transform:"translate("+this.dim.margin.left+", "+this.dim.margin.top+")"}),d3.select(this.element).select("#clipping-rect").attr({width:this.dim.innerWidth,height:Math.max(this.dim.innerHeight,0)})},i.prototype.getDimensions=function(){return this.dim},i}(e.BaseFactory);e.Container=i}(e=t.Factory||(t.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var e;!function(e){"use strict";var i=function(e){function i(t){e.call(this),this.element=t}return __extends(i,e),i.prototype.off=function(){e.prototype.off.call(this),this.hide()},i.prototype.create=function(){this.createTooltip(),this.eventMgr.on("container-move.tooltip",this.show.bind(this)),this.eventMgr.on("container-out.tooltip",this.hide.bind(this)),this.eventMgr.on("outer-world-hover.tooltip",this.showFromCoordinates.bind(this)),this.hide()},i.prototype.createTooltip=function(){var t=this.svg=d3.select(this.element).append("div").attr("class","chart-tooltip");t.append("div").attr("class","abscissas"),this.line=this.factoryMgr.get("container").overlay.append("line").attr("class","tooltip-line"),this.dots=this.factoryMgr.get("container").overlay.append("g").attr("class","tooltip-dots")},i.prototype.destroy=function(){this.svg.remove()},i.prototype.getClosestRows=function(t,e,i){for(var n=i.series.filter(function(t){return t.visible}),r=n.map(function(t){return e.getDatasetValues(t,i).filter(t.defined)}),o=[],s=-1,a=Number.POSITIVE_INFINITY,c=0;c<r.length;c++)for(var u=0;u<r[c].length;u++){if("date"===i.axes.x.type)var p=Math.abs(r[c][u].x.getTime()-t);else var p=Math.abs(r[c][u].x-t);p===a?o.push({series:n[c],row:r[c][u]}):a>p&&(a=p,o=[{series:n[c],row:r[c][u]}],s=u)}return{rows:o,index:s}},i.prototype.showFromCoordinates=function(t,e,i){if(!this.isOff()){var n=t.x,r=t.y;if(void 0===n||void 0===r)return void this.hide(void 0,e,i);n instanceof Date&&(n=n.getTime());var o=this.getClosestRows(n,e,i),s=o.rows,a=o.index;if(0===s.length)return void this.hide(void 0,e,i);this.updateTooltipDots(s),this.dots.style("opacity","1"),this.updateLinePosition(s),this.line.style("opacity","1");var c=this.getTooltipContent(s,a,i);i.tooltipHook&&(c=i.tooltipHook(s)),c&&(this.updateTooltipContent(c,a,i),this.updateTooltipPosition(s),this.svg.style("display",null))}},i.prototype.show=function(t,e,i){if(!this.isOff()){var n=this.factoryMgr.get("container"),r=n.getCoordinatesFromEvent(t);this.showFromCoordinates(r,e,i)}},i.prototype.hide=function(t,e,i){this.svg.style("display","none"),this.line.style("opacity","0"),this.dots.style("opacity","0"),i&&i.tooltipHook&&i.tooltipHook(void 0)},i.prototype.getTooltipContent=function(e,i,n){var r=n.getByAxisSide(t.Options.AxisOptions.SIDE.X).tickFormat,o=function(t){return n.getByAxisSide(t).tickFormat},s=function(t){var e=o(t.series.axis),n=e?function(t){return e(t,i)}:function(t){return t},r=n(t.row.y1);return t.series.hasTwoKeys()?"["+n(t.row.y0)+", "+r+"]":r};return{abscissas:r?r(e[0].row.x,i):e[0].row.x,rows:e.map(function(t){return{label:t.series.label,value:s(t),color:t.series.color,id:t.series.id}})}},i.prototype.updateTooltipContent=function(t,e,i){this.svg.select(".abscissas").text(t.abscissas);var n=function(t){return t.attr({"class":"tooltip-item"}),t.append("div").attr({"class":"color-dot"}).style({"background-color":function(t){return t.color}}),t.append("div").attr({"class":"series-label"}),t.append("div").attr({"class":"y-value"}),t},r=function(t){return t.select(".series-label").text(function(t){return t.label}),t.select(".y-value").text(function(t){return t.value}),t},o=this.svg.selectAll(".tooltip-item").data(t.rows,function(t,e){return t.id?t.id:e});o.enter().append("div").call(n).call(r),o.call(r),o.exit().remove()},i.prototype.updateTooltipDots=function(t){var e=this,i=this.factoryMgr.get("x-axis").scale,n=function(t){return e.factoryMgr.get(t+"-axis").scale},r=3,o=function(t,e,i){return"M "+e+" "+i+" m -"+t+", 0 a "+t+","+t+" 0 1,0 "+2*t+",0 a "+t+","+t+" 0 1,0 -"+2*t+",0 "},s=function(t){t.attr("class","tooltip-dots-group"),t.append("path").attr({"class":"tooltip-dot y1"}),t.append("path").attr({"class":"tooltip-dot y0"}).style({display:function(t){return t.series.hasTwoKeys()?null:"none"}})},a=function(t){t.select(".tooltip-dot.y1").attr({d:function(t){return o(r,i(t.row.x),n(t.series.axis)(t.row.y1))},stroke:function(t){return t.series.color}}),t.select(".tooltip-dot.y0").attr({d:function(t){return t.series.hasTwoKeys()?o(r,i(t.row.x),n(t.series.axis)(t.row.y0)):""},stroke:function(t){return t.series.color}})},c=this.dots.selectAll(".tooltip-dots-group").data(t);c.enter().append("g").call(s).call(a),c.call(a),c.exit().remove()},i.prototype.updateTooltipPosition=function(t){var e=t.slice(-1)[0],i=this.factoryMgr.get("x-axis"),n=(this.factoryMgr.get("y-axis").scale,this.factoryMgr.get("container").getDimensions().margin),r=this.element.offsetLeft,o=this.element.offsetTop,s=0,a="";i.isInLastHalf(e.row.x)?(a="translate(-100%, 0)",s=-10):s=10,this.svg.style({left:r+n.left+i.scale(e.row.x)+s+"px",top:o+n.top+"px",transform:a})},i.prototype.updateLinePosition=function(t){var e=this.factoryMgr.get("container"),i=e.getDimensions(),n=t.slice(-1)[0],r=this.factoryMgr.get("x-axis"),o=r.scale(n.row.x);this.line.attr({x1:o,x2:o,y1:-i.margin.top,y2:i.innerHeight})},i}(e.BaseFactory);e.Tooltip=i}(e=t.Factory||(t.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var e;!function(t){"use strict";var e=function(t){function e(e){t.call(this),this.element=e}return __extends(e,t),e.prototype.create=function(){this.createLegend()},e.prototype.createLegend=function(){this.div=d3.select(this.element).append("div").attr("class","chart-legend").style("position","absolute")},e.prototype.legendClick=function(){var t=this;return function(e){return e.on("click",function(e){t.eventMgr.trigger("legend-click",e)})}},e.prototype.update=function(t,e){var i=this,n=this.factoryMgr.get("container"),r=(n.getDimensions(),function(t){var e=t.append("div").attr({"class":"item"}).call(i.legendClick());e.append("div").attr({"class":"icon"}),e.append("div").attr({"class":"legend-label"})}),o=function(t){t.attr("class",function(t){return"item "+t.type.join(" ")}).classed("legend-hidden",function(t){return!t.visible}),t.select(".icon").style("background-color",function(t){return t.color}),t.select(".legend-label").text(function(t){return t.label})},s=this.div.selectAll(".item").data(e.series);s.enter().call(r),s.call(o),s.exit().remove()},e.prototype.destroy=function(){this.div.remove()},e}(t.BaseFactory);t.Legend=e}(e=t.Factory||(t.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var e;!function(e){"use strict";var i=function(e){function i(i){if(e.call(this),this.side=i,!t.Options.AxisOptions.isValidSide(i))throw new TypeError("Wrong axis side : "+i)}return __extends(i,e),i.prototype.create=function(){var t=this.factoryMgr.get("container").axes;this.createAxis(t),this.eventMgr.on("pan."+this.key,this.softUpdate.bind(this)),this.eventMgr.on("zoom-end."+this.key,this.softUpdate.bind(this)),this.eventMgr.on("outer-world-domain-change."+this.key,this.updateFromOuterWorld.bind(this)),this.eventMgr.on("resize."+this.key,this.onResize.bind(this))},i.prototype.updateFromOuterWorld=function(t){this.updateScaleDomain(t[this.side[0]]),this.softUpdate()},i.prototype.softUpdate=function(){this.factoryMgr.get("transitions").isOn()?this.svg.transition().call(this.factoryMgr.getBoundFunction("transitions","edit")).call(this.d3axis):this.svg.call(this.d3axis)},i.prototype.onResize=function(){var t=this.factoryMgr.get("container"),e=t.getDimensions();this.updateScaleRange(e),this.updateAxisContainer(e),this.softUpdate()},i.prototype.update=function(t,e){var i=this.factoryMgr.get("container"),n=i.getDimensions(),r=this.getExtent(t,e);this.options=e.getByAxisSide(this.side),this.scale=this.getScale(),this.updateScaleRange(n),this.updateScaleDomain(r),this.d3axis=this.getAxis(this.scale,this.options),this.updateAxisOrientation(this.d3axis),this.updateAxisContainer(n),this.shiftAxisTicks(this.options)},i.prototype.shiftAxisTicks=function(t){var e=t.ticksShift,i=e.x,n=e.y;this.svg.selectAll("text").attr("transform","translate("+i+", "+n+")")},i.prototype.destroy=function(){this.destroyAxis()},i.prototype.updateScaleRange=function(t){this.isAbscissas()?this.scale.range([0,t.innerWidth]):this.scale.range([t.innerHeight,0])},i.prototype.updateScaleDomain=function(t){this.scale.domain(t)},i.prototype.getScaleDomain=function(){return this.scale?this.scale.domain():[0,1]},i.prototype.getExtentForDatasets=function(t,e,i){var n=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;for(var o in t.sets)e(o)&&t.sets[o].values.forEach(function(t){var e=i(t,o);e[0]<n&&(n=e[0]),e[1]>r&&(r=e[1])});return[n===Number.POSITIVE_INFINITY?0:n,r===Number.NEGATIVE_INFINITY?1:r]},i.prototype.getExtent=function(t,e){var i=e.getByAxisSide(this.side),n=void 0;if(this.isAbscissas()){var r=e.getVisibleDatasets(),o=e.getAbsKey();n=this.getExtentForDatasets(t,function(t){return r.indexOf(t)>-1},function(t){return[t[o],t[o]]})}else{var s=e.getSeriesAndDatasetBySide(this.side),a=s.datasetsForSide,c=s.seriesForDataset;n=this.getExtentForDatasets(t,function(t){return a.indexOf(t)>-1},function(t,e){var i=c[e].map(function(e){return t[e.key.y1]}),n=c[e].map(function(e){return t[e.key.y0]||t[e.key.y1]});return[d3.min(n),d3.max(i)]})}return void 0!==i.min&&(n[0]=i.min),void 0!==i.max&&(n[1]=i.max),n},i.prototype.isAbscissas=function(){return-1!==[t.Options.AxisOptions.SIDE.X,t.Options.AxisOptions.SIDE.X2].indexOf(this.side)},i.prototype.isInLastHalf=function(t){var e=function(t){return t};t instanceof Date&&(e=function(t){return t.getTime()});var i=this.scale.domain(),n=i[0],r=i[1];return e(t)>e(n)+(e(r)-e(n))/2},i.prototype.createAxis=function(t){this.svg=t.append("g").attr("class","axis "+this.side+"-axis")},i.prototype.updateAxisOrientation=function(e){this.isAbscissas()?this.side===t.Options.AxisOptions.SIDE.X?e.orient("bottom"):e.orient("top"):this.side===t.Options.AxisOptions.SIDE.Y?e.orient("left"):e.orient("right")},i.prototype.updateAxisContainer=function(e){this.isAbscissas()?this.side===t.Options.AxisOptions.SIDE.X?this.svg.attr("transform","translate(0, "+e.innerHeight+")"):this.svg.attr("transform","translate(0, 0)"):this.side===t.Options.AxisOptions.SIDE.Y?this.svg.attr("transform","translate(0, 0)"):this.svg.attr("transform","translate("+e.innerWidth+", 0)"),this.softUpdate()},i.prototype.destroyAxis=function(){this.svg.remove()},i.prototype.invert=function(t){return this.scale.invert(t)},i.prototype.isTimeAxis=function(){return this.options.type===t.Options.AxisOptions.TYPE.DATE},i.prototype.getScale=function(){return this.options&&this.options.type===t.Options.AxisOptions.TYPE.DATE?d3.time.scale():this.options&&this.options.type===t.Options.AxisOptions.TYPE.LOG?d3.scale.log():d3.scale.linear()},i.prototype.getAxis=function(e,i){var n;return n=i.hasDynamicTicks()?t.svg.twoSpeedAxis().scale(e):d3.svg.axis().scale(e),i.configure(n),n},i.prototype.cloneAxis=function(){var e;return e=this.options&&this.options.hasDynamicTicks()?t.svg.twoSpeedAxis().ticks(this.d3axis.ticks()):d3.svg.axis().ticks(this.d3axis.ticks()[0]),e.scale(this.d3axis.scale()).orient(this.d3axis.orient()).tickValues(this.d3axis.tickValues()).tickSize(this.d3axis.tickSize())},i}(e.BaseFactory);e.Axis=i}(e=t.Factory||(t.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var e;!function(t){"use strict";var e=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.create=function(){this.svg=this.factoryMgr.get("container").axes.insert("g",":first-child").attr("class","grid"),this.svg.append("g").classed("x-grid",!0),this.svg.append("g").classed("y-grid",!0),this.eventMgr.on("resize."+this.key,this.softUpdate.bind(this)),this.eventMgr.on("pan."+this.key,this.softUpdate.bind(this)),this.eventMgr.on("zoom-end."+this.key,this.softUpdate.bind(this)),this.eventMgr.on("outer-world-domain-change."+this.key,this.softUpdate.bind(this))},e.prototype.softUpdate=function(){var t=this.factoryMgr.get("container"),e=t.getDimensions();if(this.xAxis){var i=this.svg.select(".x-grid");this.factoryMgr.get("transitions").isOn()&&(i=i.transition().call(this.factoryMgr.getBoundFunction("transitions","edit"))),i.attr("transform","translate(0, "+e.innerHeight+")").call(this.xAxis.tickSize(-e.innerHeight,0))}if(this.yAxis){var i=this.svg.select(".y-grid");this.factoryMgr.get("transitions").isOn()&&(i=i.transition().call(this.factoryMgr.getBoundFunction("transitions","edit"))),i.call(this.yAxis.tickSize(-e.innerWidth,0))}},e.prototype.update=function(t,e){var i=this.factoryMgr.get("container"),n=i.getDimensions();e.grid.x&&(this.xAxis=this.factoryMgr.get("x-axis").cloneAxis().tickSize(-n.innerHeight,0),this.svg.select(".x-grid").transition().call(this.factoryMgr.getBoundFunction("transitions","edit")).attr("transform","translate(0, "+n.innerHeight+")").call(this.xAxis)),
e.grid.y&&(this.yAxis=this.factoryMgr.get("y-axis").cloneAxis(),this.svg.select(".y-grid").transition().call(this.factoryMgr.getBoundFunction("transitions","edit")).call(this.yAxis.tickSize(-n.innerWidth,0)))},e.prototype.destroy=function(){this.svg.remove()},e}(t.BaseFactory);t.Grid=e}(e=t.Factory||(t.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var e;!function(t){"use strict";var e=function(t){function e(){t.apply(this,arguments),this.isActive=!1}return __extends(e,t),e.prototype.create=function(){this.rect=this.factoryMgr.get("container").svg.append("rect").attr("class","chart-brush")},e.prototype.constrainOutgoingDomains=function(t){this.zoomOnX||delete t.x,this.zoomOnY||delete t.y},e.prototype.update=function(t,e){var i=this.factoryMgr.get("container").getDimensions(),n=i.margin,r=n.left,o=n.top;this.zoomOnX=e.zoom.x,this.zoomOnY=e.zoom.y,(this.zoomOnX||this.zoomOnY)&&(this.xStartFn=this.zoomOnX?function(t){return t}:function(t){return r},this.xEndFn=this.zoomOnX?function(t){return t}:function(t){return i.innerWidth+r},this.yStartFn=this.zoomOnY?function(t){return t}:function(t){return o},this.yEndFn=this.zoomOnY?function(t){return t}:function(t){return i.innerHeight+o},this.registerEvents(this.factoryMgr.get("container")))},e.prototype.show=function(t){var e=t.xStart,i=t.xEnd,n=t.yStart,r=t.yEnd;o=e>i?[i,e]:[e,i],e=o[0],i=o[1],s=n>r?[r,n]:[n,r],n=s[0],r=s[1],this.rect.attr({x:e,width:i-e,y:n,height:r-n}).style("opacity","1");var o,s},e.prototype.hide=function(){this.rect.style("opacity","0")},e.prototype.updateAxes=function(t){var e=t.xStart,i=t.xEnd,n=t.yStart,r=t.yEnd;d=e>i?[i,e]:[e,i],e=d[0],i=d[1],f=n>r?[r,n]:[n,r],n=f[0],r=f[1];var o=this.factoryMgr.get("container").getDimensions(),s=o.margin,a=s.left,c=s.top,u=this.factoryMgr.get("x-axis"),p=this.factoryMgr.get("x2-axis");u.scale.domain([u.invert(e-a),u.invert(i-a)]),p.scale.domain(u.scale.domain());var h=this.factoryMgr.get("y-axis"),l=this.factoryMgr.get("y2-axis");h.scale.domain([h.invert(r-c),h.invert(n-c)]),l.scale.domain([l.invert(r-c),l.invert(n-c)]);var d,f},e.prototype.registerEvents=function(t){var e,i,n,r,o,s=this,a=function(t){return t+"."+s.key},c=function(){s.isActive=!1,s.hide(),void 0!==i&&void 0!==r&&(s.updateAxes({xStart:e,xEnd:i,yStart:n,yEnd:r}),s.eventMgr.trigger("zoom-end"),e=i=n=r=void 0,o()),s.eventMgr.on(a("window-mouseup"),null)};t.svg.on(a("mousedown"),function(){d3.event.altKey&&(o=s.factoryMgr.turnFactoriesOff(["tooltip"]),s.isActive=!0,s.eventMgr.on(a("window-mouseup"),c),t=d3.mouse(d3.event.currentTarget),e=t[0],n=t[1],e=s.xStartFn(e),n=s.yStartFn(n));var t}).on(a("mousemove"),function(){s.isActive&&(t=d3.mouse(d3.event.currentTarget),i=t[0],r=t[1],i=s.xEndFn(i),r=s.yEndFn(r),s.show({xStart:e,xEnd:i,yStart:n,yEnd:r}),s.eventMgr.trigger("zoom"));var t})},e}(t.BaseFactory);t.Zoom=e}(e=t.Factory||(t.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var e;!function(t){"use strict";var e=function(t){function e(){t.apply(this,arguments),this.isActive=!1,this.hasMoved=!1}return __extends(e,t),e.prototype.constrainOutgoingDomains=function(t){this.panOnX||delete t.x,this.panOnY||delete t.y},e.prototype.move=function(t,e){if(0!==t){var i=this.factoryMgr.get("x-axis").scale,n=this.factoryMgr.get("x2-axis").scale;i.domain(i.range().map(function(e){return e+t}).map(i.invert)),n.domain(i.domain())}if(0!==e){var r=this.factoryMgr.get("y-axis").scale,o=this.factoryMgr.get("y2-axis").scale;r.domain(r.range().map(function(t){return t+e}).map(r.invert)),o.domain(o.range().map(function(t){return t+e}).map(o.invert))}},e.prototype.update=function(t,e){var i=this;this.panOnX=e.pan.x,this.panOnY=e.pan.y;var n,r,o,s=this.factoryMgr.get("container"),a=function(t){return t+"."+i.key},c=function(){i.hasMoved&&i.eventMgr.trigger("pan-end"),o&&o(),i.isActive=i.hasMoved=!1,o=void 0,i.eventMgr.on(a("window-mouseup"),null),i.eventMgr.on(a("window-mousemove"),null)},u=function(){if(i.isActive){var t=d3.mouse(s.svg.node()),e=t[0],a=t[1],c=i.panOnX?n-e:0,u=i.panOnY?r-a:0;(0!==c||0!==u)&&(o||(o=i.factoryMgr.turnFactoriesOff(["tooltip","transitions"])),i.hasMoved=!0,i.move(c,u),i.eventMgr.trigger("pan")),p=[e,a],n=p[0],r=p[1]}var p};s.svg.on(a("mousedown"),function(){d3.event.altKey||(i.isActive=!0,t=d3.mouse(d3.event.currentTarget),n=t[0],r=t[1],i.eventMgr.on(a("window-mouseup"),c),i.eventMgr.on(a("window-mousemove"),u));var t})},e}(t.BaseFactory);t.Pan=e}(e=t.Factory||(t.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var e;!function(t){"use strict";var e=function(t){function e(){t.apply(this,arguments),this.duration=e.defaultDuration,this.ease="cubic"}return __extends(e,t),e.prototype.off=function(){t.prototype.off.call(this),this.duration=0},e.prototype.on=function(){t.prototype.on.call(this),this.duration=e.defaultDuration},e.prototype.enter=function(t){var e=this.duration,i=this.ease,n=t[0].length,r=function(t,i){return n?i/n*e:0};t.duration(e).delay(r).ease(i)},e.prototype.edit=function(t){var e=this.duration,i=this.ease,n=0;t.duration(e).delay(n).ease(i)},e.prototype.exit=function(t){var e=this.duration,i=this.ease,n=0;t.duration(e).delay(n).ease(i)},e.defaultDuration=250,e}(t.BaseFactory);t.Transition=e}(e=t.Factory||(t.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var e;!function(t){"use strict";var e=function(t){function e(e,i,n){t.call(this),this.scope=e,this.attributes=i,this.$parse=n}return __extends(e,t),e.prototype.create=function(){this.unregisteringFunctions=[],this.sanitizeAttributes(),this.syncTooltips(),this.syncDomainsChange()},e.prototype.sanitizeAttributes=function(){var t=this.attributes,e=t.tooltipSyncKey,i=t.domainsSyncKey;if(e&&i&&e===i)throw new Error("Heterogeneous sync keys can't have the same value.")},e.prototype.syncTooltips=function(){var t=this,e=this.eventMgr;this.attributes.tooltipSyncKey&&(this.unregisteringFunctions.push(this.scope.$root.$on(this.attributes.tooltipSyncKey,function(t,i){e.triggerDataAndOptions("outer-world-hover",i)})),e.on("container-move.directive",function(e){t.scope.$emit(t.attributes.tooltipSyncKey,t.factoryMgr.get("container").getCoordinatesFromEvent(e))}),e.on("container-out.directive",function(){t.scope.$emit(t.attributes.tooltipSyncKey,{x:void 0,y:void 0})}))},e.prototype.syncDomainsChange=function(){var t=this,e=this.eventMgr,i=[],n=this.factoryMgr.get("x-axis"),r=this.factoryMgr.get("y-axis");if(this.attributes.onDomainsChange){var o=this.$parse(this.attributes.onDomainsChange);i.push(function(e,i){var n=i.isEndEvent;n&&o(t.scope.$parent,{$domains:e})})}this.attributes.domainsSyncKey&&(this.unregisteringFunctions.push(this.scope.$root.$on(this.attributes.domainsSyncKey,function(i,o,s){i.targetScope!==t.scope&&(o.x&&o.y||(o=angular.copy(o)),o.x||(o.x=n.getScaleDomain()),o.y||(o.y=r.getScaleDomain()),"zoom-end"===s?(e.trigger("outer-world-domain-change",o),t.factoryMgr.turnFactoriesOn(["tooltip"])):"zoom"===s?t.factoryMgr.turnFactoriesOff(["tooltip"]):"pan"===s||"pan-end"===s?(t.factoryMgr.turnFactoriesOff(["transitions","tooltip"]),e.trigger("outer-world-domain-change",o),"pan-end"===s&&t.factoryMgr.turnFactoriesOn(["transitions","tooltip"])):"zoom-pan-reset"===s&&e.trigger("zoom-pan-reset",!1))})),i.push(function(e,i){var n=i.type;t.scope.$emit(t.attributes.domainsSyncKey,e,n)}));var s=function(){return{x:n.getScaleDomain(),y:r.getScaleDomain()}},a=function(t,e){return i.forEach(function(i){return i(t,e)})};e.on("pan.directive",function(){var e=s();t.factoryMgr.get("pan").constrainOutgoingDomains(e),a(e,{type:"pan"})}),e.on("pan-end.directive",function(){var e=s();t.factoryMgr.get("pan").constrainOutgoingDomains(e),a(e,{type:"pan-end",isEndEvent:!0})}),e.on("zoom.directive",function(){var e=s();t.factoryMgr.get("zoom").constrainOutgoingDomains(e),a(e,{type:"zoom",isEndEvent:!1})}),e.on("zoom-end.directive",function(){var e=s();t.factoryMgr.get("zoom").constrainOutgoingDomains(e),a(e,{type:"zoom-end",isEndEvent:!0})}),e.on("zoom-pan-reset.directive",function(t){t&&a(s(),{type:"zoom-pan-reset",isEndEvent:!0})})},e.prototype.destroy=function(){for(var t;t=this.unregisteringFunctions.pop();)t()},e}(t.BaseFactory);t.SyncLayer=e}(e=t.Factory||(t.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var e;!function(e){var i;!function(e){"use strict";var i=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.create=function(){this.createContainer(this.factoryMgr.get("container").data),this.eventMgr.on("data-update."+this.type,this.update.bind(this)),this.eventMgr.on("pan."+this.type,this.softUpdate.bind(this)),this.eventMgr.on("zoom-end."+this.type,this.softUpdate.bind(this)),this.eventMgr.on("outer-world-domain-change."+this.key,this.softUpdate.bind(this)),this.eventMgr.on("resize."+this.type,this.softUpdate.bind(this))},e.prototype.update=function(t,e){this.data=t,this.options=e,this.softUpdate()},e.prototype.getAxes=function(t){return{xAxis:this.factoryMgr.get("x-axis"),yAxis:this.factoryMgr.get(t.axis+"-axis")}},e.prototype.softUpdate=function(){var t=this.options.getSeriesByType(this.type).filter(function(t){return t.visible});this.updateSeriesContainer(t)},e.prototype.destroy=function(){this.svg.remove()},e.prototype.createContainer=function(t){this.svg=t.append("g").attr("class",this.type+e.containerClassSuffix)},e.prototype.updateSeriesContainer=function(t){var i=this,n=this.svg.selectAll("."+this.type+e.seriesClassSuffix).data(t,function(t){return t.id});n.enter().append("g").attr({"class":function(t){return i.type+e.seriesClassSuffix+" "+t.id}}),this.styleSeries(n),this.updateSeries(n,t),n.exit().remove()},e.prototype.updateSeries=function(t,e){var i=this;t.each(function(t,n){var r=d3.select(this);i.updateData(r,t,n,e.length)})},e.prototype.updateData=function(t,e,i,n){},e.prototype.styleSeries=function(t){},e.containerClassSuffix="-data",e.seriesClassSuffix="-series",e}(t.Factory.BaseFactory);e.SeriesFactory=i}(i=e.Series||(e.Series={}))}(e=t.Factory||(t.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var e;!function(e){var i;!function(i){"use strict";var n=function(e){function i(){e.apply(this,arguments),this.type=t.Options.SeriesOptions.TYPE.DOT}return __extends(i,e),i.prototype.updateData=function(t,e,i,n){var r=this.getAxes(e),o=r.xAxis,s=r.yAxis,a=this.data.getDatasetValues(e,this.options).filter(e.defined),c=2,u=t.selectAll("."+this.type).data(a,function(t){return t.x}),p=function(t){t.attr({r:function(t){return c},cx:function(t){return o.scale(t.x)},cy:function(t){return s.scale.range()[0]}})},h=function(t){t.attr({cx:function(t){return o.scale(t.x)},cy:function(t){return s.scale(t.y1)}}).style("opacity",e.visible?1:0)};this.factoryMgr.get("transitions").isOn()?(u.enter().append("circle").attr("class",this.type).call(this.eventMgr.datumEnter(e,this.options)).call(this.eventMgr.datumOver(e,this.options)).call(this.eventMgr.datumMove(e,this.options)).call(this.eventMgr.datumLeave(e,this.options)).call(p).transition().call(this.factoryMgr.getBoundFunction("transitions","enter")).call(h),u.transition().call(this.factoryMgr.getBoundFunction("transitions","edit")).call(h),u.exit().transition().call(this.factoryMgr.getBoundFunction("transitions","exit")).call(p).each("end",function(){d3.select(this).remove()})):(u.enter().append("circle").attr("class",this.type).call(this.eventMgr.datumEnter(e,this.options)).call(this.eventMgr.datumOver(e,this.options)).call(this.eventMgr.datumMove(e,this.options)).call(this.eventMgr.datumLeave(e,this.options)).call(h),u.call(h),u.exit().remove())},i.prototype.styleSeries=function(t){t.style({stroke:function(t){return t.color}})},i}(e.Series.SeriesFactory);i.Dot=n}(i=e.Series||(e.Series={}))}(e=t.Factory||(t.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var e;!function(e){var i;!function(i){"use strict";var n=function(e){function i(){e.apply(this,arguments),this.type=t.Options.SeriesOptions.TYPE.LINE}return __extends(i,e),i.prototype.updateData=function(t,e,i,n){t.classed("dashed",e.isDashed());var r=this.getAxes(e),o=r.xAxis,s=r.yAxis,a=this.data.getDatasetValues(e,this.options),c=d3.svg.line().defined(e.defined).x(function(t){return o.scale(t.x)}).y(s.scale.range()[0]).interpolate(e.interpolation.mode).tension(e.interpolation.tension),u=d3.svg.line().defined(e.defined).x(function(t){return o.scale(t.x)}).y(function(t){return s.scale(t.y1)}).interpolate(e.interpolation.mode).tension(e.interpolation.tension),p=t.selectAll("."+this.type).data([a]);this.factoryMgr.get("transitions").isOn()?(p.enter().append("path").attr("class",this.type).attr("d",function(t){return c(t)}).transition().call(this.factoryMgr.getBoundFunction("transitions","enter")).attr("d",function(t){return u(t)}),p.transition().call(this.factoryMgr.getBoundFunction("transitions","edit")).attr("d",function(t){return u(t)}).style("opacity",e.visible?1:0),p.exit().transition().call(this.factoryMgr.getBoundFunction("transitions","exit")).attr("d",function(t){return c(t)}).each("end",function(){d3.select(this).remove()})):(p.enter().append("path").attr("class",this.type).attr("d",function(t){return u(t)}),p.attr("d",function(t){return u(t)}).style("opacity",e.visible?1:0),p.exit().remove())},i.prototype.styleSeries=function(t){t.style({fill:"none",stroke:function(t){return t.color},"stroke-dasharray":function(t){return t.isDashed()?"10,3":void 0}})},i}(e.Series.SeriesFactory);i.Line=n}(i=e.Series||(e.Series={}))}(e=t.Factory||(t.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var e;!function(e){var i;!function(i){"use strict";var n=function(e){function i(){e.apply(this,arguments),this.type=t.Options.SeriesOptions.TYPE.AREA}return __extends(i,e),i.prototype.updateData=function(t,e,i,n){var r=this.getAxes(e),o=r.xAxis,s=r.yAxis,a=this.data.getDatasetValues(e,this.options),c=d3.svg.area().defined(e.defined).x(function(t){return o.scale(t.x)}).y0(s.scale.range()[0]).y1(s.scale.range()[0]).interpolate(e.interpolation.mode).tension(e.interpolation.tension),u=d3.svg.area().defined(e.defined).x(function(t){return o.scale(t.x)}).y0(function(t){return isNaN(s.scale(t.y0))?s.scale.range()[0]:s.scale(t.y0)}).y1(function(t){return s.scale(t.y1)}).interpolate(e.interpolation.mode).tension(e.interpolation.tension),p=t.selectAll("."+this.type).data([a]);this.factoryMgr.get("transitions").isOn()?(p.enter().append("path").attr("class",this.type).attr("d",function(t){return c(t)}).transition().call(this.factoryMgr.getBoundFunction("transitions","enter")).attr("d",function(t){return u(t)}),p.transition().call(this.factoryMgr.getBoundFunction("transitions","edit")).attr("d",function(t){return u(t)}).style("opacity",e.visible?1:0),p.exit().transition().call(this.factoryMgr.getBoundFunction("transitions","exit")).attr("d",function(t){return c(t)}).each("end",function(){d3.select(this).remove()})):(p.enter().append("path").attr("class",this.type).attr("d",function(t){return u(t)}),p.attr("d",function(t){return u(t)}).style("opacity",e.visible?1:0),p.exit().remove())},i.prototype.styleSeries=function(t){t.style({fill:function(t){return t.color},stroke:function(t){return t.color}})},i}(e.Series.SeriesFactory);i.Area=n}(i=e.Series||(e.Series={}))}(e=t.Factory||(t.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){var e;!function(e){var i;!function(i){"use strict";var n=function(e){function i(){e.apply(this,arguments),this.type=t.Options.SeriesOptions.TYPE.COLUMN,this.gapFactor=.2,this.outerPadding=this.gapFactor/2*3,this.columnsWidth=0}return __extends(i,e),i.prototype.softUpdate=function(){var t=this.options.getSeriesByType(this.type).filter(function(t){return t.visible});this.updateColumnsWidth(t,this.options),this.updateColumnScale(t,this.options),this.updateSeriesContainer(t)},i.prototype.update=function(t,e){this.data=t,this.options=e;var i=e.getSeriesByType(this.type).filter(function(t){return t.visible});this.updateColumnsWidth(i,e),this.updateColumnScale(i,e),this.updateSeriesContainer(i)},i.prototype.updateColumnsWidth=function(e,i){var n=this.factoryMgr.get("x-axis"),r=this.data.getDatasets(e,i),o=t.Utils.Data.getMinDistance(r,n.scale,"x");this.columnsWidth=o<Number.MAX_VALUE?o/e.length:10},i.prototype.updateColumnScale=function(t,e){var i=this.columnsWidth*t.length/2;this.innerXScale=d3.scale.ordinal().domain(t.map(function(t){return t.id})).rangeBands([-i,i],0,.1)},i.prototype.getTooltipPosition=function(t){return this.innerXScale(t.id)+this.innerXScale.rangeBand()/2},i.prototype.updateData=function(t,e,i,n){var r=this,o=this.getAxes(e),s=o.xAxis,a=o.yAxis,c=this.data.getDatasetValues(e,this.options).filter(e.defined),u=function(t){return s.scale(t.x)+r.innerXScale(e.id)},p=function(t){t.attr({x:u,y:function(t){return a.scale(t.y0)},width:r.innerXScale.rangeBand(),height:0})},h=function(t){t.attr({x:u,y:function(t){return t.y1>0?a.scale(t.y1):a.scale(t.y0)},width:r.innerXScale.rangeBand(),height:function(t){return Math.abs(a.scale(t.y0)-a.scale(t.y1))}}).style("opacity",e.visible?1:0)},l=t.selectAll("."+this.type).data(c,function(t){return t.x});this.factoryMgr.get("transitions").isOn()?(l.enter().append("rect").attr("class",this.type).call(this.eventMgr.datumEnter(e,this.options)).call(this.eventMgr.datumOver(e,this.options)).call(this.eventMgr.datumMove(e,this.options)).call(this.eventMgr.datumLeave(e,this.options)).call(p).transition().call(this.factoryMgr.getBoundFunction("transitions","enter")).call(h),l.transition().call(this.factoryMgr.getBoundFunction("transitions","edit")).call(h),l.exit().transition().call(this.factoryMgr.getBoundFunction("transitions","exit")).call(p).each("end",function(){d3.select(this).remove()})):(l.enter().append("rect").attr("class",this.type).call(this.eventMgr.datumEnter(e,this.options)).call(this.eventMgr.datumOver(e,this.options)).call(this.eventMgr.datumMove(e,this.options)).call(this.eventMgr.datumLeave(e,this.options)).call(h),l.call(h),l.exit().remove())},i.prototype.styleSeries=function(t){t.style({fill:function(t){return t.color},stroke:function(t){return t.color},"stroke-width":1})},i}(e.Series.SeriesFactory);i.Column=n}(i=e.Series||(e.Series={}))}(e=t.Factory||(t.Factory={}))}(n3Charts||(n3Charts={}));var n3Charts;!function(t){"use strict";var e=function(){function e(e,i,n,r){var o=this;this.$window=e,this.$parse=i,this.$timeout=n,this.$rootScope=r,this.scope={data:"=",options:"=",styles:"=",hoveredCoordinates:"="},this.restrict="E",this.replace=!0,this.template="<div></div>",this.link=function(e,i,n){var r,s,a=new t.Utils.EventManager,c=new t.Utils.FactoryManager;a.init(t.Utils.EventManager.EVENTS),c.registerMany([["container",t.Factory.Container,i[0]],["tooltip",t.Factory.Tooltip,i[0]],["legend",t.Factory.Legend,i[0]],["transitions",t.Factory.Transition],["x-axis",t.Factory.Axis,t.Options.AxisOptions.SIDE.X],["x2-axis",t.Factory.Axis,t.Options.AxisOptions.SIDE.X2],["y-axis",t.Factory.Axis,t.Options.AxisOptions.SIDE.Y],["y2-axis",t.Factory.Axis,t.Options.AxisOptions.SIDE.Y2],["grid",t.Factory.Grid],["pan",t.Factory.Pan],["zoom",t.Factory.Zoom],["sync-layer",t.Factory.SyncLayer,e,n,o.$parse],["series-area",t.Factory.Series.Area],["series-column",t.Factory.Series.Column],["series-line",t.Factory.Series.Line],["series-dot",t.Factory.Series.Dot]]),c.all().forEach(function(t){return t.instance.init(t.key,a,c)});var u=void 0===e.options,p=function(){s=new t.Options.Options(angular.copy(e.options)),r=new t.Utils.Data(e.data),u&&(u=!1,a.trigger("create",s)),a.update(r,s),a.trigger("update",r,s)};u||a.trigger("create",new t.Options.Options(angular.copy(e.options)));var h=function(t){t&&(r.fromJS(t),c.turnFactoriesOff(["transitions"]),a.trigger("data-update",r,s),c.turnFactoriesOn(["transitions"]),a.trigger("update",r,s))};e.$watch("options",p,!0),e.$watch("data",h,!0),a.on("legend-click.directive",function(t){var i=e.options.series.filter(function(e){return e.id===t.id})[0];i.visible=t.getToggledVisibility(),e.$apply()});var l=function(){if(!i||!i[0])return{};var t=i[0].parentElement.getBoundingClientRect();return{height:t.height,width:t.width,left:t.left,right:t.right,bottom:t.bottom,top:t.top}},d=t.Utils.FunctionUtils.debounce(function(){a.trigger("resize",i[0].parentElement)},50);e.$watch(l,d,!0);var f=t.Utils.FunctionUtils.debounce(function(){return e.$apply()},50);angular.element(o.$window).on("resize",f),e.$on("$destroy",function(){a.trigger("destroy"),angular.element(o.$window).off("resize",f)})}}return e}();t.LineChart=e}(n3Charts||(n3Charts={})),angular.module("n3-line-chart",[]).directive("linechart",["$window","$parse","$timeout","$rootScope",function(t,e,i,n){return new n3Charts.LineChart(t,e,i,n)}]);